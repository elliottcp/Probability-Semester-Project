---
title: "Vignette Title"
author: "Vignette Author"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Rejection Sampling Function for 1-Dimensional Samples}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

**Background** 
Rejection sampling is one method of collecting a random sample from along a single dimension.  Rejection sampling works as follows: First, two uniform sample sets are produced, paired, and plotted.  In this case, pairs of samples are produced and plotted 1000 times.  Then, of the 1000 points, only points under the pdf curve are taken as part of the sample.  Any point over the curve is rejected from the sample.  Thus, an X value is proportionally more likely to be accepted as part of the sample if it falls underneath a higher part of the pdf.  The non-rejected points are the product of THEFUNCTION1D.  

Perhaps it will be easiest to understand visually.  First, 1000 uniformly distributed coordinate pairs were generated.  Then, only the 622 points (black) that fall underneath the pdf curve were selected.  The other 378 were rejected (gray).  

```{r}
n <- 1000
x <- runif(n,0,1)
y <- runif(n,0,1)
points <- cbind(x,y)
names(points) <- c("x", "y")
dark_sample <- data.frame()
light_sample <- data.frame()

pdf <- function(x) {exp(-x)}

for(i in 1:n) {
  dark <- points[i,2] < pdf(points[i,1])
  if(dark) dark_sample <- rbind(dark_sample, points[i,]) else light_sample <- rbind(light_sample, points[i,])
}

str(dark_sample)

names(dark_sample) <- c("X","Y")
names(light_sample) <- c("X", "Y")

library(ggplot2)

ggplot(data = dark_sample, aes(X, Y)) +
  geom_point() + 
  geom_point(data = light_sample, aes(X,Y), color = "gray") +
  stat_function(fun = pdf)

```


**Example #1: Standard Normal Distribution**
```{r}
pdf <- function(x) {dnorm(x,0,1)}
sample <- THEFUNCTION1D(pdf, n = 100000, lower_bound = -5, upper_bound = 5, C = 0.4)
print(sample)
hist(sample)
```


**Example #2: Uniform distribution(a=-10, b=10)**
```{r}
pdf <- function(x) {dunif(x,-10,10)}
THEFUNCTION1D(pdf, n = 20, lower_bound = -10, upper_bound = 10, C = 0.06)
```

**Example #3: Exponential(lambda = 7)**
```{r}
pdf <- function(x) {dexp(x,7)}
THEFUNCTION1D(pdf, n = 8, lower_bound = 0, upper_bound = 100, C = 50)
```


**Example #4: Gamma(alpha = 12, beta = 0.6)**
```{r}
pdf <- function(x) {dgamma(x, 12, 0.6)}
THEFUNCTION1D(pdf, n = 100, lower_bound = 0, upper_bound = 100, C = 50)
```

**Example #5: Beta(alpha = 6, beta = 8)**
```{r}
pdf <- function(x) {dbeta(x,6,8)}
THEFUNCTION1D(pdf, n = 100, lower_bound = 0, upper_bound = 1, C = 1)
```


